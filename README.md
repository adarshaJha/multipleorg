# Multiple Org
## Multi Org/Peer

You will be provisioning a local network with the following docker container configuration:

* 2 CA
* A SOLO orderer
* 2 Org (2 Peers per Org)

#### Artifacts
* Crypto material has been generated using the **cryptogen** tool from Hyperledger Fabric and mounted to all peers, the orderering node and CA containers. More details regarding the cryptogen tool are available [here](http://hyperledger-fabric.readthedocs.io/en/latest/build_network.html#crypto-generator).
* An Orderer genesis block (genesis.block) and channel configuration transaction (mychannel.tx) has been pre generated using the **configtxgen** tool from Hyperledger Fabric and placed within the artifacts folder. More details regarding the configtxgen tool are available [here](http://hyperledger-fabric.readthedocs.io/en/latest/build_network.html#configuration-transaction-generator).

###### This example makes use of configtxgen and is for development ONLY. Make use of Fabric-CA for production environments

```
cd /usr/local/hyperledger/fabric-samples/basic-network
cd /usr/local/hyperledger/fabric-samples/demo-app
```

#### Setup:

* Define/Change crypto-config.yaml
  * Make sure you set EnableNodeOUs: true 
* Network Topology
  * OrdererOrgs
    * Name
    * Domain
    * Hostname 
  * PeerOrgs
    * Name 
  * Domain Users
    * Count 1 in addition to Admin
* Define/Change docker-compose.yml 
  * FABRIC_CA_SERVER_CA_KEYFILE
* Define/Change ./generate.sh (Based on Profiles defined in configtx.yaml)
* Define/Change ./start.sh (Change channel name)
* Run startFabric.sh, and replace the new key by inspecting docker logs ca.example.com
  * Everytime you generate new crypto material, make sure you update "FABRIC_CA_SERVER_CA_KEYFILE" in the "docker-compose.yml" file
* Bring up the n/w by running startFabric.sh 
  * launch network; create channel and join peer to channel
  * launch CLI container in order to install, instantiate chaincode
  * bootstrap/ledger with property
* Enroll Admin and Register the User
  * node registerAdmin.js
  * node registerUser.js
* Start server 
  * node server.js http://localhost:8000

#### To Do/Findings:

* Investigate the certificates generated by cryptogen using `openssl x509 -in ./path/to/cert.pem -text -noout` 
* `msp/config.yaml` should NOT be placed into both the orderer and peers' MSP directory. It must ONLY go into the peers.
